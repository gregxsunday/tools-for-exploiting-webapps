{% extends "layout.html" %}
{% block body %}
    <div class="container">
        <div class="row">
            <h1>Create a new SSRF payloads list</h1>
        </div>

        <label for="target_domain">Target domain:</label>
        <input id="target_domain" type="text" name="msg" placeholder="Target domain">
        <br>
        <label for="forgery_domain">Attack result domain:</label>
        <input id="forgery_domain" type="text" name="msg" placeholder="Attack result domain">
        <br>
        <input id="buttonInput" type="submit" value="Send">
        
        <div id="response">
        </div>
    </div>
    <script>
        function sendDomain() {
            var target_domain = $("#target_domain").val();
            var forgery_domain = $("#forgery_domain").val();
            var xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function () {
                $("#result").text("");
                if (this.readyState == 4 && this.status == 200) {
                    var response = '<p><span>List creation started!</span></p>';
                    $("#response").append(response);
                } else if (this.readyState == 4 && this.status == 400) {
                    var response = '<p><span>Something went wrong!</span></p>';
                    $("#response").append(response);
                } else if (this.readyState == 4 && this.status == 403) {
                    var response = '<p><span>Wrong domain name!</span></p>';
                    $("#response").append(response);
                } else if (this.readyState == 4 && this.status == 500) {
                    var response = '<p><span>Something went wrong with the server!</span></p>';
                    $("#response").append(response);
                }
            }
            const data = new FormData();
            data.append("target_domain", target_domain);
            data.append("forgery_domain", forgery_domain);
            xhttp.open("POST", "/payloads/create_payloads", true);
            xhttp.send(data);
        };

        $("#textInput").keypress(function (e) {
                if (e.which == 13) {
                    sendDomain();
                }
        });

        $("#buttonInput").click(function () {
                sendDomain();
        });
    </script>

{% endblock %}