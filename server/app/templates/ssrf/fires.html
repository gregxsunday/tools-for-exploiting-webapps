{% extends "layout.html" %}
{% block body %}
<div class="container">
    {% if alert is defined%}
    <div class="alert alert-primary" role="alert">
        {{alert}}
      </div>
    {% endif %}

    <h2>Fires {% if target %} for target: {{target.name|e}} {% endif %}</h2>
    <table class="table">
        <thead>
          <tr>
            <th scope="col">Target</th>
            <th scope="col">Date</th>
            <th scope="col">Domain</th>
            <th scope="col">Type</th>
            <th scope="col">Payload</th>
            <th scope="col">Headers</th>
          </tr>
        </thead>
        <tbody>
            
            {% for fire in fires %}
                <tr>
                  <td>{{fire.target.name|e}}</td>
                  <td>{{fire.date.strftime("%Y-%m-%d %H:%M")|e}}</td>
                  <td>{{fire.target.domain|e}}</td>
                  <td>{{'DNS' if fire.dns_fire else 'HTTP'}}</td>
                  <td>{{fire.payload|e}}</td>
                  <td>
                      {% for header in fire.headers.split('\n') %}
                        {{header|e}}<br>
                      {% endfor %}

                  </td>
                </tr>
            {% endfor %}
        </tbody>
      </table>
</div>
{% endblock %}